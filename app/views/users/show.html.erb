<% if @user == current_user %>

  <%# new post form %>
  <%= render 'posts/form', user: @user %>

  <%# all posts of user %>
  <%= render 'posts/all_posts_of_user', user: @user, delete_rights: true %>

<% else %>

  <%# friend request button %>
  <% if @friend_request = current_user.the_sent_friend_request_to(@user) %>
    <%= button_to 'Friend request sent', user_friend_request_path(@user, @friend_request), method: :delete, data: { turbo_method: :delete, turbo_confirm: 'Remove friend request?' } %>
  <% elsif @friend_request = current_user.the_received_friend_request_from(@user) %>
    <%= form_with model: [@user, @friend_request] do |f| %>
      <%= f.submit 'Accept friend request' %>
    <% end %>
  <% elsif @friend_request = current_user.the_accepted_friend_request_with(@user) %>
      <%= button_to 'Unfriend', user_friend_request_path(@user, @friend_request), method: :delete, data: { turbo_method: :delete, turbo_confirm: 'Remove friend?' } %>
  <% else %>
    <%= form_with model: [@user, @user.received_friend_requests.build] do |f| %>
      <%= f.submit 'Add friend' %>
    <% end %>
  <% end %>

  <%# all posts of user %>
  <%= render 'posts/all_posts_of_user', user: @user, delete_rights: false %>

<%end%>

